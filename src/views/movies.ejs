<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= listTitle %> | MoviePass</title>
    <link rel="stylesheet" href="../css/style.css" />
  </head>
  <body class="bg-darkest-grey text-off-white text-center">
    <header class="py-6 px-12 bg-darker-grey">
      <nav class="flex justify-center md:justify-around items-center">
        <ul class="flex">
          <li>
            <a
              href="/changelog"
              class="p-2 hover:text-teal hover:transition-color hover:duration-300 active:text-med-teal active:transition-colors active:duration-300 motion-reduce:hover:transition-none"
              >Changelog</a
            >
          </li>
        </ul>
        <ul class="flex">
          <% if (user !== undefined) { %>
          <li>
            <a
              href="/lists"
              class="p-2 hover:text-teal hover:transition-color hover:duration-300 active:text-med-teal active:transition-colors active:duration-300 motion-reduce:hover:transition-none"
              >My Lists</a
            >
          </li>
          <li>
            <a
              href="/logout"
              class="p-2 hover:text-teal hover:transition-color hover:duration-300 active:text-med-teal active:transition-colors active:duration-300 motion-reduce:hover:transition-none"
              >Log Out</a
            >
          </li>
          <% } else { %>
          <li>
            <a
              href="/login"
              class="p-2 hover:text-teal hover:transition-color hover:duration-300 active:text-med-teal active:transition-colors active:duration-300 motion-reduce:hover:transition-none"
              >Login</a
            >
          </li>
          <li>
            <a
              href="/signup"
              class="p-2 hover:text-teal hover:transition-color hover:duration-300 active:text-med-teal active:transition-colors active:duration-300 motion-reduce:hover:transition-none"
              >Sign Up</a
            >
          </li>
          <% } %>
        </ul>
      </nav>
    </header>

    <h1 class="text-teal text-2xl tracking-tighter md:text-5xl mt-6 md:mt-12">
      <%= listTitle %>
    </h1>
    <% if (user !== undefined && isAuthed && !isActive) { %>
    <form action="/lists/makeActive/<%= listId %>?_method=PUT" method="post">
      <button>Make <%= listTitle %> your active list</button>
    </form>
    <% } else if (user !== undefined && isAuthed && isActive) { %>
    <h3 class="italic">Your Currently Active List</h3>
    <% } %> <% if (user !== undefined) { %> <%- include('partials/searchmovies')
    -%> <% } %>

    <main
      class="moviesList flex justify-center items-center mb-12 px-6 md:px-0"
    >
      <ul class="text-left mt-6 px-6">
        <% movies.forEach( movie => { %>
        <li class="movieName list-disc my-2" data-id="<%=movie._id%>">
          <a
            href="https://www.themoviedb.org/movie/<%= movie.movieId %>"
            class="underline underline-offset-2 hover:text-teal hover:transition-color hover:duration-300 active:text-med-teal active:transition-colors active:duration-300 motion-reduce:hover:transition-none"
            ><%=movie.movieTitle%> <% if (movie.movieYear != -1) { %>
            (<%=movie.movieYear%>)<% } %></a
          >
          <% if (user !== undefined && movies[0].userId == user.id) { %>
          <form
            action="/movies/deleteMovie/<%= movie.id %>?_method=DELETE"
            method="post"
            class="inline"
          >
            <button class="align-middle">
              <iconify-icon
                inline
                icon="ci:trash-full"
                class="text-xl md:text-2xl hover:text-teal hover:transition-color hover:duration-300 active:text-med-teal active:transition-colors active:duration-300 motion-reduce:hover:transition-none"
                aria-label="remove movie from list"
                onclick="return confirm('Are you sure you want to delete this movie from your list: <%= listTitle %>?')"
              ></iconify-icon>
            </button>
          </form>
          <% } %>
        </li>
        <% }) %>
      </ul>
    </main>
    <script src="https://code.iconify.design/iconify-icon/1.0.0/iconify-icon.min.js"></script>
  </body>
</html>
